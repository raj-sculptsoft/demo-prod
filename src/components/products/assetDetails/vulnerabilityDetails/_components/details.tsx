import { Card } from "@/components/ui/card";
import { Textarea } from "@/components/ui/textarea";
import { DetailsProps } from "@/types/vulnerability";
import AnalysisChart from "./analysis-chart";
import RiskMatrix from "./risk-matrix";
import StatsCard from "./stats-card";

export default function Details({
  id,
  impact,
  severity,
  cwe,
  cve,
  description,
  recommendation,
  confidence_score,
  positivity,
  likelihood,
  exploitability,
  vulnerability,
}: DetailsProps) {
  return (
    <Card>
      <div className="border-b p-4">
        <h3 className="mb-3 text-lg font-bold">{vulnerability}</h3>
        <p>ID: {id}</p>
      </div>
      <div className="p-4 pb-2">
        <div className="grid grid-cols-1 gap-8 border-b pb-3 lg:grid-cols-2">
          <div className="space-y-5">
            <div className="grid grid-cols-1 gap-6 md:grid-cols-2">
              <AnalysisChart key="impact" title="Impact" value={impact} />
              <AnalysisChart key="severity" title="Severity" value={severity} />
            </div>
            <div className="grid grid-cols-1 gap-6 md:grid-cols-2">
              {!positivity && (
                <StatsCard
                  title="False Positive"
                  description={confidence_score?.toString() + "%" || "N/A"}
                  showInformationIcon={false}
                />
              )}
              <StatsCard
                title="CWE"
                description={cwe ?? "N/A"}
                showShare={!!cwe}
              />
              <StatsCard
                title="CVE"
                description={cve ?? "N/A"}
                showShare={!!cve && cve !== "No CVE assigned"}
              />
            </div>
          </div>

          <RiskMatrix likelihood={likelihood} impact={impact} />
        </div>
        <div className="space-y-3 pb-3 pt-5 text-base text-borderColor-dark">
          <p>
            <span className="font-bold">Exploitability:</span> {exploitability}
          </p>

          <div>
            <p className="font-bold">Description</p>
            <Textarea
              readOnly
              className="resize-none text-base"
              value={description}
            />
          </div>

          <p>
            <span className="font-bold">Recommendation:</span> {recommendation}
          </p>
        </div>
      </div>
    </Card>
  );
}
