import Share from "@/assets/icons/share";
import { Card, CardContent } from "@/components/ui/card";

interface IStatsCard {
  title?: string;
  description: string;
  showShare?: boolean;
}

export default function StatsCard({
  title,
  description,
  showShare = false,
}: IStatsCard) {
  const getDynamicLink = () => {
    if (title === "CWE" && description.startsWith("CWE-")) {
      // Use regex to match the CWE number part before any colon or additional text
      const match = description.match(/^CWE-(\d+)/);

      if (match) {
        const id = match[1]; // This will capture the numeric part after "CWE-"
        return `https://cwe.mitre.org/data/definitions/${id}.html`;
      }
    }

    if (title === "CVE" && description.startsWith("CVE-")) {
      // Generate a link to NIST's CVE vulnerability details page
      return `https://nvd.nist.gov/vuln/detail/${description}`;
    }

    return null;
  };

  const dynamicLink = getDynamicLink();

  return (
    <Card className="statsCardShadow max-h-24 w-full basis-60 bg-white">
      <CardContent className="px-4 py-6">
        <div className="space-y-1">
          <p className="flex justify-between text-lg font-bold">
            <span>
              {description.length > 23
                ? `${description.slice(0, 23)}...`
                : description}
            </span>
            {showShare && dynamicLink && (
              <a
                href={dynamicLink}
                target="_blank"
                rel="noopener noreferrer"
                className="text-secondary hover:underline"
              >
                <Share />
              </a>
            )}
          </p>
        </div>
      </CardContent>
    </Card>
  );
}
